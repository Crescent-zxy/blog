# 异步与回调

### 异步

* 同步：能直接拿到结果

* 异步：不能直接拿到结果

  ###### 拿结果的方式：

  * 轮询，定时询问结果
  * 回调，结果作为回调函数的第一个参数

##### 判断同步异步

函数返回值处于：

* setTimeout
* AJAX ( XMLHttpRequest )
* addEventListener

内部，该函数就是异步函数

### 回调

* 写给别人调用的函数
* 自己不调用

例：onreadystatechange 函数，由浏览器调用

#### 两个结果

解决方法：

* 回调接受两个参数

  ```javascript
  fs.readFile('/index.html', (error, data)=>{
      if(error){
          // 失败
      }
      // 成功
  })
  ```

* 使用两个回调

  ```javascript
  ajax.('get', '/index.html', data() => {}, error() => {})
  // 前面是成功回调，后面是失败回调
  -------
  ajax('get', '/index.html', {
      success: () => {},
      fail: () => {}
  })
  // 接受一个对象，对象有两个key表示成功和失败
  ```

###### 不足

* 不规范
* 回调地狱
* 很难进行错误处理

### 关联

* 异步任务在得到结果时通知 JS 拿结果
* JS 留一个函数地址给浏览器
* 异步任务完成时浏览器调用该函数地址
* 同时把结果作为参数传给该函数
* 这个函数是写给浏览器调用的，是回调函数

###### 区别

* 异步任务需要回调函数通知结果
* 回调函数不一定只在异步任务里
* 回调函数可以在同步任务中使用
* 同步回调：`array.forEach(n => console.log(n))`